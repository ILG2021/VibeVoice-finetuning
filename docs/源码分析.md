假如audio是2秒24k的音频，shape就是48000，vae压缩比3200，有15个vae token表示

Collator的输出：
{
    # ========================================
    # input_ids: [batch_size, 81]
    # 展示为字符串便于理解
    # ========================================
    "input_ids": [
        # ===== 位置 0-20: System Prompt (21 tokens) =====
        " Transform",           # 0
        " the",                 # 1
        " text",                # 2
        " provided",            # 3
        " by",                  # 4
        " various",             # 5
        " speakers",            # 6
        " into",                # 7
        " speech",              # 8
        " output",              # 9
        ",",                    # 10
        " utilizing",           # 11
        " the",                 # 12
        " distinct",            # 13
        " voice",               # 14
        " of",                  # 15
        " each",                # 16
        " respective",          # 17
        " speaker",             # 18
        ".",                    # 19
        "\n",                   # 20
        
        # ===== 位置 21-28: Voice Prompt Header (8 tokens) =====
        " Voice",               # 21
        " input",               # 22
        ":",                    # 23
        "\n",                   # 24
        " Speaker",             # 25
        " ",                    # 26
        "0",                    # 27
        ":",                    # 28
        
        # ===== 位置 29: Speech Start Token =====
        "<|speech_start|>",     # 29
        
        # ===== 位置 30-44: Voice Prompt VAE Tokens (15 tokens) ⭐ =====
        "<|speech_diffusion|>", # 30
        "<|speech_diffusion|>", # 31
        "<|speech_diffusion|>", # 32
        "<|speech_diffusion|>", # 33
        "<|speech_diffusion|>", # 34
        "<|speech_diffusion|>", # 35
        "<|speech_diffusion|>", # 36
        "<|speech_diffusion|>", # 37
        "<|speech_diffusion|>", # 38
        "<|speech_diffusion|>", # 39
        "<|speech_diffusion|>", # 40
        "<|speech_diffusion|>", # 41
        "<|speech_diffusion|>", # 42
        "<|speech_diffusion|>", # 43
        "<|speech_diffusion|>", # 44
        
        # ===== 位置 45-46: Voice Prompt End (2 tokens) =====
        "<|speech_end|>",       # 45
        "\n",                   # 46
        
        # ===== 位置 47-53: Text Input Header (7 tokens) =====
        " Text",                # 47
        " input",               # 48
        ":",                    # 49
        "\n",                   # 50
        " Speaker",             # 51
        " ",                    # 52
        "0",                    # 53
        
        # ===== 位置 54-58: Text Content (5 tokens) =====
        ":",                    # 54
        " Speaker0",            # 55
        " transcription",       # 56
        ".",                    # 57
        "\n",                   # 58
        
        # ===== 位置 59-63: Speech Output Header (5 tokens) =====
        " Speech",              # 59
        " output",              # 60
        ":",                    # 61
        "\n",                   # 62
        "<|speech_start|>",     # 63
        
        # ===== 位置 64-78: Target Audio VAE Tokens (15 tokens) ⭐⭐⭐ =====
        # 🔥 这些是 Collator 添加的！Processor 输出中没有！
        "<|speech_diffusion|>", # 64 - Target token 1
        "<|speech_diffusion|>", # 65 - Target token 2
        "<|speech_diffusion|>", # 66 - Target token 3
        "<|speech_diffusion|>", # 67 - Target token 4
        "<|speech_diffusion|>", # 68 - Target token 5
        "<|speech_diffusion|>", # 69 - Target token 6
        "<|speech_diffusion|>", # 70 - Target token 7
        "<|speech_diffusion|>", # 71 - Target token 8
        "<|speech_diffusion|>", # 72 - Target token 9
        "<|speech_diffusion|>", # 73 - Target token 10
        "<|speech_diffusion|>", # 74 - Target token 11
        "<|speech_diffusion|>", # 75 - Target token 12
        "<|speech_diffusion|>", # 76 - Target token 13
        "<|speech_diffusion|>", # 77 - Target token 14
        "<|speech_diffusion|>", # 78 - Target token 15
        
        # ===== 位置 79-80: 结束标记 (2 tokens) =====
        "<|speech_end|>",       # 79
        "<|eos|>"               # 80
    ],
    # 总长度: 81 tokens
    
    # ========================================
    # attention_mask: [batch_size, 81]
    # ========================================
    "attention_mask": [
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  # 0-9: System prompt
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1,  # 10-19
        1, 1, 1, 1, 1, 1, 1, 1, 1,     # 20-28: Voice header
        1,                              # 29: <|speech_start|>
        1, 1, 1, 1, 1,                  # 30-34: Voice VAE (前5个)
        1, 1, 1, 1, 1,                  # 35-39
        1, 1, 1, 1, 1,                  # 40-44: Voice VAE (后5个)
        1, 1,                           # 45-46: <|speech_end|> + \n
        1, 1, 1, 1, 1, 1, 1,            # 47-53: Text header
        1, 1, 1, 1, 1,                  # 54-58: Text content
        1, 1, 1, 1,                     # 59-62: Speech header
        1,                              # 63: <|speech_start|>
        1, 1, 1, 1, 1,                  # 64-68: Target VAE (前5个)
        1, 1, 1, 1, 1,                  # 69-73
        1, 1, 1, 1, 1,                  # 74-78: Target VAE (后5个)
        1, 1                            # 79-80: <|speech_end|> + <|eos|>
    ],
    
    # ========================================
    # acoustic_input_mask: [batch_size, 81]
    # 标记哪些位置是 acoustic tokens
    # ========================================
    "acoustic_input_mask": [
        # 0-29: 文本部分 - False
        False, False, False, False, False,  # 0-4: " Transform the text provided"
        False, False, False, False, False,  # 5-9: " by various speakers into speech"
        False, False, False, False, False,  # 10-14: ", utilizing the distinct voice"
        False, False, False, False, False,  # 15-19: " of each respective speaker ."
        False,                              # 20: "\n"
        False, False, False, False,         # 21-24: " Voice input :\n"
        False, False, False, False,         # 25-28: " Speaker   0 :"
        False,                              # 29: "<|speech_start|>"
        
        # 30-44: Voice Prompt 的 VAE tokens - True ⭐
        True, True, True, True, True,       # 30-34: 5个 <|speech_diffusion|>
        True, True, True, True, True,       # 35-39: 5个 <|speech_diffusion|>
        True, True, True, True, True,       # 40-44: 5个 <|speech_diffusion|>
        
        # 45-63: 文本部分 - False
        False, False,                       # 45-46: "<|speech_end|> \n"
        False, False, False, False,         # 47-50: " Text input :\n"
        False, False, False,                # 51-53: " Speaker   0"
        False, False, False, False, False,  # 54-58: ": Speaker0 transcription .\n"
        False, False, False, False,         # 59-62: " Speech output :\n"
        False,                              # 63: "<|speech_start|>"
        
        # 64-78: Target Audio 的 VAE tokens - True ⭐⭐⭐
        True, True, True, True, True,       # 64-68: 5个 <|speech_diffusion|>
        True, True, True, True, True,       # 69-73: 5个 <|speech_diffusion|>
        True, True, True, True, True,       # 74-78: 5个 <|speech_diffusion|>
        
        # 79-80: 结束标记 - False
        False, False                        # 79-80: "<|speech_end|> <|eos|>"
    ],
    # 总共 30 个 True: 位置 30-44 (voice) + 位置 64-78 (target)
    
    # ========================================
    # acoustic_loss_mask: [batch_size, 81]
    # 标记哪些位置需要计算 acoustic loss
    # ========================================
    "acoustic_loss_mask": [
        # 0-63: 全部 False (不计算 loss)
        False, False, False, False, False,  # 0-4
        False, False, False, False, False,  # 5-9
        False, False, False, False, False,  # 10-14
        False, False, False, False, False,  # 15-19
        False,                              # 20
        False, False, False, False,         # 21-24
        False, False, False, False,         # 25-28
        False,                              # 29: <|speech_start|>
        
        # ❌ 注意: Voice Prompt VAE tokens 不计算 loss!
        False, False, False, False, False,  # 30-34: Voice VAE
        False, False, False, False, False,  # 35-39
        False, False, False, False, False,  # 40-44
        
        False, False,                       # 45-46
        False, False, False, False,         # 47-50
        False, False, False,                # 51-53
        False, False, False, False, False,  # 54-58
        False, False, False, False,         # 59-62
        False,                              # 63: <|speech_start|>
        
        # 64-78: 只有 Target VAE tokens 计算 loss! ⭐⭐⭐
        True, True, True, True, True,       # 64-68: Target VAE (计算loss!)
        True, True, True, True, True,       # 69-73
        True, True, True, True, True,       # 74-78
        
        # 79-80: False
        False, False                        # 79-80
    ],
    # 只有 15 个 True: 仅位置 64-78 (target)
    
    # ========================================
    # speech_tensors: [2, 48000]
    # 所有音频段的原始波形
    # ========================================
    "speech_tensors": [
        # Segment 0: Voice Prompt Audio (2秒 @ 24kHz)
        # 对应序列中位置 30-44 的 15 个 VAE tokens
        [
            0.0234, -0.0156, 0.0432, 0.0123, -0.0089,  # 前5个采样点
            0.0167, -0.0234, 0.0056, 0.0345, -0.0123,
            # ... 共 48000 个采样点
            0.0012, -0.0034, 0.0067, 0.0023, -0.0045   # 最后5个采样点
        ],
        
        # Segment 1: Target Audio (2秒 @ 24kHz)
        # 对应序列中位置 64-78 的 15 个 VAE tokens
        [
            0.0145, -0.0234, 0.0312, 0.0089, -0.0167,  # 前5个采样点
            0.0234, -0.0123, 0.0078, 0.0256, -0.0189,
            # ... 共 48000 个采样点
            0.0089, -0.0023, 0.0045, 0.0012, -0.0034   # 最后5个采样点
        ]
    ],
    # shape: (2, 48000)
    
    # ========================================
    # speech_masks: [2, 15]
    # 每个音频段有多少个有效的 VAE token
    # ========================================
    "speech_masks": [
        # Segment 0: Voice Prompt - 15个 VAE tokens 全部有效
        # 对应位置 30-44
        [True, True, True, True, True,      # VAE tokens 0-4
         True, True, True, True, True,      # VAE tokens 5-9
         True, True, True, True, True],     # VAE tokens 10-14
        
        # Segment 1: Target Audio - 15个 VAE tokens 全部有效
        # 对应位置 64-78
        [True, True, True, True, True,      # VAE tokens 0-4
         True, True, True, True, True,      # VAE tokens 5-9
         True, True, True, True, True]      # VAE tokens 10-14
    ],
    # shape: (2, 15)
    
    # ========================================
    # speeches_loss_input: [2, 15]
    # 标记哪些音频段需要计算 reconstruction loss
    # ========================================
    "speeches_loss_input": [
        # Segment 0: Voice Prompt - 不计算 loss ❌
        [False, False, False, False, False,
         False, False, False, False, False,
         False, False, False, False, False],
        
        # Segment 1: Target Audio - 计算 loss ✅✅✅
        [True, True, True, True, True,
         True, True, True, True, True,
         True, True, True, True, True]
    ],
    # shape: (2, 15)
    
    # ========================================
    # speech_semantic_tensors: [2, 15, 128]
    # 语义特征 (如果 compute_semantics=True)
    # ========================================
    "speech_semantic_tensors": [
        # Segment 0: Voice Prompt 的语义特征
        # 对应位置 30-44 的 15 个 VAE tokens
        [
            [0.123, -0.456, 0.789, ..., 0.012],  # Frame 0 (128维)
            [0.234, -0.567, 0.890, ..., 0.023],  # Frame 1
            [0.345, -0.678, 0.901, ..., 0.034],  # Frame 2
            # ... 共 15 frames
            [0.456, -0.789, 0.012, ..., 0.045]   # Frame 14
        ],
        
        # Segment 1: Target Audio 的语义特征
        # 对应位置 64-78 的 15 个 VAE tokens
        [
            [0.567, -0.890, 0.123, ..., 0.056],  # Frame 0 (128维)
            [0.678, -0.901, 0.234, ..., 0.067],  # Frame 1
            [0.789, -0.012, 0.345, ..., 0.078],  # Frame 2
            # ... 共 15 frames
            [0.890, -0.123, 0.456, ..., 0.089]   # Frame 14
        ]
    ]
    # shape: (2, 15, 128)
}
```

---

## 可视化对照表
```
位置    Token 文本                      acoustic_input  acoustic_loss   说明
                                        _mask           _mask
================================================================================
0-20    System Prompt 文本              False           False           系统提示
21-28   Voice header 文本               False           False           语音输入头
29      <|speech_start|>               False           False           开始标记

30      <|speech_diffusion|>            ✅ True         ❌ False         Voice VAE 1
31      <|speech_diffusion|>            ✅ True         ❌ False         Voice VAE 2
32      <|speech_diffusion|>            ✅ True         ❌ False         Voice VAE 3
...     ...                             ✅ True         ❌ False         ...
44      <|speech_diffusion|>            ✅ True         ❌ False         Voice VAE 15

45      <|speech_end|>                  False           False           结束标记
46-58   Text input 文本                  False           False           文本输入
59-62   Speech output header            False           False           语音输出头
63      <|speech_start|>                False           False           开始标记

64      <|speech_diffusion|>            ✅ True         ✅ True          Target VAE 1 🔥
65      <|speech_diffusion|>            ✅ True         ✅ True          Target VAE 2 🔥
66      <|speech_diffusion|>            ✅ True         ✅ True          Target VAE 3 🔥
...     ...                             ✅ True         ✅ True          ...
78      <|speech_diffusion|>            ✅ True         ✅ True          Target VAE 15 🔥

79      <|speech_end|>                  False           False           结束标记
80      <|eos|>                         False           False           EOS标记